Для каждого дня в таблице orders рассчитайте следующие показатели:

Выручку, полученную в этот день.
Суммарную выручку на текущий день.
Прирост выручки, полученной в этот день, относительно значения выручки за предыдущий день.
Колонки с показателями назовите соответственно revenue, total_revenue, revenue_change. Колонку с датами назовите date.

Прирост выручки рассчитайте в процентах и округлите значения до двух знаков после запятой.
Результат должен быть отсортирован по возрастанию даты.
Поля в результирующей таблице: date, revenue, total_revenue, revenue_change

SELECT 
	date, 
	revenue, 
	SUM(revenue) OVER(ROWS UNBOUNDED PRECEDING) AS total_revenue, 
	ROUND((revenue / LAG(revenue) OVER() * 100 - 100), 2) AS revenue_change
FROM (
    SELECT date, SUM(price) AS revenue
    FROM (
        SELECT DATE(creation_time) AS DATE, UNNEST(product_ids) AS product_id
        FROM orders
        WHERE order_id NOT IN (SELECT order_id FROM user_actions WHERE action = 'cancel_order')
        ) t1
    LEFT JOIN products USING(product_id)
    GROUP BY date
    ORDER BY date
    ) t2 ;

-----------------------------------------------------------------------------------------------------------------------------